Оглавление

	Защита от межсайтового скриптинга (XSS)

	Защита от подделки межсайтового запроса (CSRF)

	Защита от внедрения SQL

	Защита от скликивания

	SSL/HTTPS

	Проверка заголовка хоста

	Безопасность сессии

	Контент, загружаемый пользователями

Защита от межсайтового скриптинга (XSS)

	XSS атаки позволяют вставить собственные JS скрипты в браузеры других пользователей и запустить их.

	Это достигается с помощью:

		Предложения пользователю нажать на какую-нибудь кнопку или ссылку.

		Добавить этот скрипт в куки при переходе пользователя на сайт злоумышленника.

	XSS атаки могут происходить из любого недоверенного источника данных, такого как куки или веб сервисы.

Защита от подделки межсайтового запроса (CSRF)

	CSRF атаки позволяют недобросовестному пользователю выполнять действия от имени другого пользователя, без ведома последнего или его согласия.

	Схема работы такая:

		Пользователь прошел аутентификация на сайте платежной системы.

		Пользователь окрыл новую вкладку в браузере и перешел на другой сайт (сайт злоумышленника).

		Сайт злоумышленника тайно сделал запрос от лица пользователя на сайт платежной системы и перевел деньги со счета пользователя на счет злоумышленника.

	CSRF защита проверяет метку с текущим временем в каждом POST запросе.

	Именно поэтому в каждой форме должен быть csrf token.

Защита от внедрения SQL

	Внедрение SQL - это тип атаки, когда недобросовестный пользователь имеет возможность выполнить в базе данных определённый SQL запрос. 

	Результатом выполнения такого запроса может быть удаление или даже утечка данных.

	Такая атака может быть возможна из-за некорректной обработки входных данных, используемых в SQL-запросах.

	Для защиты от данного типа атак необходимо тщательно фильтровать входные параметры.

	Например для MySQL, требуется брать в кавычки все строковые параметры.

	По умолчанию за нас это делает orm, но об этом нужно знать и помнить если мы делаем сырые запросы.

	При использовании Django ORM созданный SQL запрос будет правильно экранирован соответствующим драйвером базы данных.

Защита от скликивания

	Это тип атаки, когда вредоносный сайт оборачиваем другой сайт фо фрейм и пользователи могут совершать действия на этом сайте ничего не подозревая.

	Django предоставляет защиту от этой атаки в виде модуля X-Frame-Options, который, при использовании соответствующего браузера, может предотвратить отображение сайта внутри фрейма.

SSL/HTTPS

	При отсутствии HTTPS злоумышленник имеет возможность перехватывать аутентификационные данные или любую другую информацию, передаваемую между клиентом и сервером.

	Настройте перенаправление HTTP запросов на HTTPS.

	Если браузер изначально подключается через HTTP, что характерно для большинства браузеров, есть возможность утечки существующих кук.

Проверка заголовка хоста

	Клиент отправляет на север заголовок host.

	Поддельный заголовок Host может быть использован для атак CSRF, подмены кэша и для подмены ссылок в сообщениях электронной почты.

	Django использует заголовок Host, предоставляемый клиентом, для создания URL в определённых случаях. 

	Django проверяет этот заголовок относительно параметра конфигурации ALLOWED_HOSTS.

		Но если ваш код получает содержимое заголовка Host напрямую из request.META, то вы игнорируете эту защиту.

Безопасность сессии

	Поддомены внутри сайта имеют возможность устанавливать куки на клиенте для всего домена.

	Это приводит к возможности управления сессией, если куки принимаются от поддоменов, которые не находятся под управлением доверенных пользователей.

	Например, атакующий может авторизоваться на good.example.com и получить достоверную сессию для своего аккаунта.

	Если у атакующего есть контроль над bad.example.com, он может использовать его для отправки своего ключа сессии вам, так как поддомену разрешено устанавливать куки для *.example.com. 

	Когда вы посетите good.example.com, вы будете авторизован как атакующий и можете непреднамеренно внести важные персональные данные (например, номер кредитной карты) в аккаунт атакующего.

Контент, загружаемый пользователями

	Если ваш сайт принимает файлы, настоятельно советуем ограничить размер таких загрузок в конфигурации веб сервера для предотвращения атак на отказ сервиса (DOS).
