Оглавление

	Что это

	Главный конфигурационный файл

	Секция http

	Секция server

	Docker

	Команды

Что это

	Это веб сервер.

	Веб сервер — это компьютерная программа, запускаемая на подключённом к сети компьютере и использующая протокол HTTP для передачи данных. 

	В простейшем виде такая программа получает по сети HTTP-запрос на определённый ресурс, находит соответствующий файл на локальном жёстком диске и отправляет его по сети запросившему компьютеру. Более сложные веб-серверы способны в ответ на HTTP-запрос динамически генерировать документы с помощью шаблонов и сценариев.

	Для загрузки и просмотра веб-страниц используются специальные программы — браузеры. Браузер это клиент.

Главный конфигурационный файл

	По умолчанию, конфигурационный файл называется nginx.conf и расположен в каталоге /usr/local/nginx/conf, /etc/nginx/conf.d/default.conf или /usr/local/etc/nginx

	Конфигурационный файл NGINX состоит из секций.

	В глобальной секции задаются параметры, оказывающие влияние на сервер в целом. Глобальная секция не заключается в фигурные скобки. Обычно пишется в файле nginx.conf

		user  nginx;
		worker_processes  1;

		error_log  /var/log/nginx/error.log warn;
		pid        /var/run/nginx.pid;

	Глобальная секция должна находиться в начале конфигурационного файла nginx.conf

	В главный файл конфигурации можно подключать файлы. Если указан не полный путь, то NGINX считает, что путь задан относительно главного местоположения конфигурационного файла.

		include /etc/nginx/conf.d/*.conf;

Секция http

	Секция http описывает http сервер. Сюда входят настройки соединения с клиентом, работа со статикой, сокетами.

	Секция server описывает виртуальный сервер. По умолчанию секция server находиться в отдельном файле, который подключается в секцию http. Этот файл называется default.conf. Его можно найти в etc/nginx/conf.d/default.conf.

		server {
			listen 80; - порт
    		server_name localhost; - ip адресс

		    location / {
		        root   /usr/share/nginx/html; - директория с файлом
		        index  index.html index.htm; - тип и имя файла
		    }
		}

	Виртуальные сервера отвечают на запросы по протоколу HTTP.

	Помимо обычной строки, NGINX допускает использование в директиве server_name метасимвола *

		Метасимвол можно указывать вместо поддомена: *.example.com

		Метасимвол можно указывать вместо домена верхнего уровня www.example.*

		Параметр директивы server_name может быть и регулярным выражением

	Чтобы определить, какой виртуальный сервер должен обслужить данный запрос, NGINX применяется следующий алгоритм:

		Сопоставить IP-адрес и порт с указанными в директиве listen

		Сопоставить заголовок Host со значением директивы server_name, рассматриваемым как строка

	Признак default_server позволяет обработать запросы, которые иначе остались бы необработанными. Поэтому рекомендуется всегда задавать этот признак явно, чтобы не гадать потом, почему запросы обрабатываются странным образом. Кроме того, признак default_server полезен, когда требуется сконфигурировать несколько виртуальных серверов с одной и той же директивой listen.

Docker

	docker run --name test-nginx -v /home/grisha/nginx:/usr/share/nginx/html:ro -d nginx

	http://localhost:8080

	docker exec -it container_name bash

	cd etc/nginx/conf.d/default.conf

Команды

	nginx -s reload - перезагрузка конфигурации