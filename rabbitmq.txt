Оглавление

	Что это

	Установка и настройка

	Команды

	Основные понятия

	Общая схема работы

	Producer (поставщик)

	Queue (очередь)

	Consumer (подписчик)

Что это

	RabbitMQ ‒ это брокер сообщений

	Его основная цель принимать и отдавать сообщения

	Используется если нужно доставить задачу от одного приложения в другое

	RabbitMQ является одновременно и почтовым ящиком, и почтовым отделением, и почтальоном

	Для использования RabbitMQ необходима библиотека.

	Для python бывают следующие библиотеки: py-amqplib, txAMQP, pika

Установка и настройка

	wget https://packages.erlang-solutions.com/erlang-solutions_1.0_all.deb

	sudo dpkg -i erlang-solutions_1.0_all.deb

	sudo apt-get update

	sudo apt-get install erlang erlang-nox

	echo 'deb http://www.rabbitmq.com/debian/ testing main' | sudo tee /etc/apt/sources.list.d/rabbitmq.list

	wget -O- https://www.rabbitmq.com/rabbitmq-release-signing-key.asc | sudo apt-key add -

	sudo apt-get update

	sudo apt-get install rabbitmq-server

	sudo systemctl enable rabbitmq-server
	sudo systemctl start rabbitmq-server
	sudo systemctl stop rabbitmq-server

	sudo rabbitmqctl add_user admin password 
	sudo rabbitmqctl set_user_tags admin administrator
	sudo rabbitmqctl set_permissions -p / admin ".*" ".*" ".*"

	sudo rabbitmq-plugins enable rabbitmq_management

	start rabbit manage panel on http://localhost:15672

	pip install pika

Команды

	rabbitmqctl list_queues - выводит список очередей

Основные понятия

	Поставщик, очередь, подписчик, брокер

	Поставщик, подписчик и брокер обычно находяться на разных машинах

Общая схема работы

	Подключаем библиотеку для работы с брокером. В моём случае pika.

	Есть 2 файла. В 1 код для поставщика, во втором для подписчика.

	В каждом из файлов:

		Подключаемся к брокеру.

		Создаём очередь. В двух файлах, потому что неизвестно какой из них запустится первым, а если очередь не будет существовать, то rabbit проигнорирует сообщение от поставщика.

		В файле поставщике отправляем сообщение в очередь и закрываем соединение с брокером.

		В файле подписчике принимаем сообщение из очереди и запускаем бесконечный процесс, который слушает очередь и если там появляются сообщения, извлекает их из неё.

Producer (поставщик)

	Программа, которая отправляет сообщения. Обозначается буквой P

Queue (очередь)

	Находится внутри обменника, то есть находится внтури RabbitMQ

	Сообщения хранятся в очередях

	Любое кол-во поставщиков могут отправлять сообщения в очередь

	Любое кол-во подписчиков могут получать сообщения из одной очереди

	Очереди создаются и в файлах поставщиках и в файлах подписчиках. Это нужно потому что мы не знаем какой файл сработает раньше. При этом каждая очередь с одинаковым названием будет созданна только единожды

Consumer (подписчик)

	Программа принимающая сообщения

	Находится в состоянии ожидания сообщений


